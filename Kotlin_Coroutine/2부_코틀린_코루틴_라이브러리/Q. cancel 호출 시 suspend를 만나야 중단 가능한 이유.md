ì½”ë£¨í‹´ì—ì„œ `cancel()` í˜¸ì¶œë§Œìœ¼ë¡œëŠ” ì¦‰ì‹œ ì¤‘ë‹¨ë˜ì§€ ì•Šê³ , **ì¤‘ë‹¨ ì§€ì (suspension point)**ì„ ë§Œë‚˜ì•¼ ì¤‘ë‹¨ ê°€ëŠ¥í•œ ì´ìœ ëŠ” **í˜‘ë ¥ì  ì·¨ì†Œ(cooperative cancellation)** ë°©ì‹ìœ¼ë¡œ ì„¤ê³„ë˜ì–´ ìžˆê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤.

---

## ðŸ” ì´ìœ  ìš”ì•½

1. **ì½”ë£¨í‹´ì€ í˜‘ë ¥ì  ëª¨ë¸ì„ ë”°ë¥´ê¸° ë•Œë¬¸ì—**
2. **ì¤‘ë‹¨ ê°€ëŠ¥ ì§€ì ì´ ìžˆì–´ì•¼ `CancellationException`ì„ ë˜ì§ˆ ìˆ˜ ìžˆê¸° ë•Œë¬¸ì—**
3. **`suspend` í‚¤ì›Œë“œê°€ í¬í•¨ëœ í•¨ìˆ˜ëŠ” ì¤‘ë‹¨ì„ ì²´í¬í•˜ê³  ì˜ˆì™¸ë¥¼ ë˜ì§ˆ ìˆ˜ ìžˆëŠ” ì§€ì ì´ê¸° ë•Œë¬¸**

---

## ðŸ’¡ ìžì„¸í•œ ì„¤ëª…

### 1. **ì½”ë£¨í‹´ì˜ ì·¨ì†ŒëŠ” ì¦‰ì‹œ ì¤‘ë‹¨ì´ ì•„ë‹ˆë‹¤**

`cancel()`ì„ í˜¸ì¶œí•˜ë©´, ë‚´ë¶€ì ìœ¼ë¡œëŠ” ì½”ë£¨í‹´ì˜ `Job` ìƒíƒœê°€ **`isActive = false`**ê°€ ë˜ê³ , `CancellationException`ì´ ì¤€ë¹„ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ **ì½”ë£¨í‹´ ì½”ë“œê°€ ê³„ì† ì‹¤í–‰ ì¤‘ì´ë©´ ì¤‘ë‹¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**

ì˜ˆë¥¼ ë“¤ì–´:

```kotlin
kotlin
ë³µì‚¬íŽ¸ì§‘
val job = CoroutineScope(Dispatchers.Default).launch {
    repeat(1000) { i ->
        println("ìž‘ì—…ì¤‘ $i ...")
        delay(100) // <- suspend í•¨ìˆ˜ (ì¤‘ë‹¨ ì§€ì )
    }
}
delay(500)
job.cancel() // ì½”ë£¨í‹´ ì·¨ì†Œ ìš”ì²­

```

ìœ„ ì½”ë“œëŠ” `delay()`ê°€ ìžˆìœ¼ë¯€ë¡œ ì·¨ì†Œ ìš”ì²­ì´ ë°˜ì˜ë©ë‹ˆë‹¤. `delay()` ë‚´ë¶€ëŠ” suspend í•¨ìˆ˜ì´ê³ , ì´ í•¨ìˆ˜ëŠ” ì‹¤í–‰ ì¤‘ `isActive`ë¥¼ í™•ì¸í•´ì„œ `CancellationException`ì„ ë˜ì§ˆ ìˆ˜ ìžˆëŠ” êµ¬ì¡°ì´ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤.

---

### 2. **ì¤‘ë‹¨ ì§€ì (suspension point)ì´ëž€?**

`suspend` í•¨ìˆ˜ ì¤‘ ì¼ë¶€ëŠ” **ì½”ë£¨í‹´ ì»¨í…ìŠ¤íŠ¸ì˜ ìƒíƒœë¥¼ í™•ì¸**í•´ì„œ, ë§Œì•½ `isActive == false`ë©´ `CancellationException`ì„ ë˜ì§‘ë‹ˆë‹¤. ëŒ€í‘œì ìœ¼ë¡œ:

- `delay()`
- `withContext()`
- `yield()`
- `suspendCoroutine {}` (ì§ì ‘ êµ¬í˜„ ì‹œ ì£¼ì˜ í•„ìš”)

> whileì´ë‚˜ for ê°™ì€ ë£¨í”„ë§Œ ìžˆëŠ” ê²½ìš°ì—”, ì¤‘ë‹¨ ê°€ëŠ¥ ì§€ì ì´ ì—†ì–´ì„œ ê³„ì† ëŒì•„ê°.
> 

---

### 3. **ì¤‘ë‹¨ ì§€ì ì´ ì—†ë‹¤ë©´?**

```kotlin
kotlin
ë³µì‚¬íŽ¸ì§‘
launch {
    repeat(1_000_000) { i ->
        println("ê³„ì† ì‹¤í–‰ì¤‘: $i")
        // delay ê°™ì€ suspend í•¨ìˆ˜ê°€ ì—†ìŒ
    }
}

```

ì´ëŸ° ì½”ë“œëŠ” `cancel()` í˜¸ì¶œí•´ë„ ì¤‘ë‹¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ìœ ëŠ” ë‹¨ í•˜ë‚˜:

> ì·¨ì†Œë¥¼ ì²´í¬í•˜ê±°ë‚˜ ì˜ˆì™¸ë¥¼ ë˜ì§ˆ íƒ€ì´ë°ì´ ì—†ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤.
> 

---

## âœ… í•´ê²° ë°©ë²•

ì·¨ì†Œë¥¼ ë°˜ì˜í•˜ê¸° ìœ„í•´ì„œëŠ” ì¤‘ê°„ì¤‘ê°„ì— ë‹¤ìŒì„ í˜¸ì¶œí•´ì•¼ í•©ë‹ˆë‹¤:

- `delay()`, `yield()` ë“±ì˜ suspend í•¨ìˆ˜ ì‚¬ìš©
- í˜¹ì€ ì§ì ‘ `ensureActive()` í˜¸ì¶œ:

```kotlin
kotlin
ë³µì‚¬íŽ¸ì§‘
import kotlinx.coroutines.*

launch {
    repeat(1_000_000) { i ->
        coroutineContext.ensureActive() // <- ì·¨ì†Œ ìƒíƒœ í™•ì¸
        println("ê³„ì† ì‹¤í–‰ì¤‘: $i")
    }
}

```

---

## ðŸ”š ì •ë¦¬

| ê°œë… | ì„¤ëª… |
| --- | --- |
| `cancel()` | Job ìƒíƒœë¥¼ inactiveë¡œ ë§Œë“¤ê³  ì·¨ì†Œ ìš”ì²­ |
| ì¤‘ë‹¨ ì§€ì  | `suspend` í•¨ìˆ˜ë¡œ êµ¬í˜„ë˜ì–´ ìžˆì–´ì•¼ í•˜ê³ , ë‚´ë¶€ì—ì„œ `isActive` í™•ì¸í•¨ |
| ì¤‘ë‹¨ ë¶ˆê°€ëŠ¥í•œ ìƒí™© | ìˆœìˆ˜ ì—°ì‚°ë§Œ ê³„ì†ë  ë•Œ (`suspend` í•¨ìˆ˜ ì—†ìŒ) |
| í•´ê²° | `suspend` í•¨ìˆ˜ ì‚¬ìš© or `ensureActive()` ì§ì ‘ í˜¸ì¶œ |
